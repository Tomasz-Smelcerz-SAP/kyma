{{- if .Capabilities.APIVersions.Has "cert-manager.io/v1alpha2" }}
apiVersion: cert-manager.io/v1alpha2
kind: ClusterIssuer
metadata:
  name: kyma-ca-issuer
  namespace: {{ .Release.Namespace }}
spec:
  ca:
    secretName: kyma-ca-key-pair
---
apiVersion: cert-manager.io/v1alpha2
kind: Certificate
metadata:
  name: kyma-gateway-certs
  namespace: {{ .Release.Namespace }}
spec:
  duration: 720h
  renewBefore: 10m
  keySize: 4096
  organization:
  - kyma
  commonName: {{ .Values.global.domainName }}
  dnsNames:
  - "*.{{ .Values.global.domainName }}"
  secretName: kyma-gateway-certs
  issuerRef:
    name: kyma-ca-issuer
    kind: ClusterIssuer
    group: cert-manager.io
{{- end }}
